server {
        listen 9080 default_server;

        location /vault/ {
            proxy_pass  http://localhost:8200/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Accept-Encoding ""; # needed for sub_filter to work with gzip enabled (https://stackoverflow.com/a/36274259/3375325)
            proxy_redirect /ui/ /vault/ui/;
            sub_filter '<head>' '<head><base href="/vault/">';
            sub_filter '"/ui/' '"ui/';
            sub_filter_once off;
            #allow 172.30.32.2/32;
            #deny all
        }

        location /v1 {
            proxy_pass http://localhost:8200;
            #allow 172.30.32.2/32;
            #deny all
        }
}